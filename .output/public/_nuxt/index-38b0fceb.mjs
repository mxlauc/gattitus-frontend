import{_ as b,o as r,c as _,b as e,h as u,t as g,d as m,p as w,F as A,i as E,g as x,z as T,u as v,a as y,j as I,e as L,w as O,f as F,y as U,v as q,x as G,q as H,l as S,r as W}from"./entry-de171b54.mjs";import{C as D,N as M,a as N,P as B,R as V}from"./NewComment-08c02d24.mjs";import{I as j}from"./ImagePreloader-6a18e78e.mjs";const J={components:{ComentarioComponent:D,NewComment:M},setup(){return{mainStore:v()}},data(){return{comentarios:null,comentariosPaginador:null}},props:["postId"],emits:["contadorActualizado"],mounted(){y.get(`${this.mainStore.backendUrl}/api/posts/${this.postId}/comments`).then(t=>{this.$emit("contadorActualizado",t.data.meta.total),this.comentariosPaginador=t.data.links,this.comentarios=t.data.data}).catch(t=>{console.log(t)})},methods:{cargarMasComentarios(){y.get(this.comentariosPaginador.next).then(t=>{this.comentariosPaginador=t.data.links,this.comentarios=this.comentarios.concat(t.data.data)}).then(()=>{this.$refs.commentsDiv.scrollTop=0}).catch(t=>{console.log(t)})},onCommented(t){this.comentarios.unshift(t),window.setTimeout(()=>{this.$refs.commentsDiv.scrollTop=this.$refs.commentsDiv.scrollHeight},200)},contadorActualizado(t){this.$emit("contadorActualizado",t)},commentDeleted(t){const c=this.comentarios.findIndex(s=>s.id===t);this.comentarios.splice(c,1)},commentEdited(t){const c=this.comentarios.find(s=>s.id===t.id);c.description=t.description}}},K=Object.assign(J,{setup(t,{expose:c}){c();const s={ComentarioComponent:D,NewComment:M,axios:y,useMainStore:v,t:I};return Object.defineProperty(s,"__isScriptSetup",{enumerable:!1,value:!0}),s}}),Q={style:{height:"100%",display:"flex","flex-direction":"column"}},X={key:0,class:"my-0"},Y={key:2,class:"my-0"},Z={style:{overflow:"hidden auto","scroll-behavior":"smooth","flex-grow":"1"},class:"ps-3 pe-0 custom-scroll",ref:"commentsDiv"};function $(t,c,s,o,i,n){var a;return r(),_("div",null,[e("div",Q,[(a=i.comentarios)!=null&&a.length?(r(),_("hr",X)):u("",!0),i.comentariosPaginador&&i.comentariosPaginador.next?(r(),_("a",{key:1,class:"d-block text-muted text-center py-2 fw-bold",style:{"font-size":"12px","text-decoration":"none"},role:"button",onClick:c[0]||(c[0]=(...d)=>n.cargarMasComentarios&&n.cargarMasComentarios(...d))},g(o.t("previousComments")),1)):u("",!0),i.comentariosPaginador&&i.comentariosPaginador.next?(r(),_("hr",Y)):u("",!0),e("div",Z,[m(T,{name:"grupo-comentarios"},{default:w(()=>{var d;return[(r(!0),_(A,null,E((d=i.comentarios)==null?void 0:d.slice().reverse(),l=>(r(),x(o.ComentarioComponent,{"post-id":s.postId,key:l.id,comentario:l,onCommentDeleted:n.commentDeleted,onContadorActualizado:n.contadorActualizado,onCommentEdited:n.commentEdited},null,8,["post-id","comentario","onCommentDeleted","onContadorActualizado","onCommentEdited"]))),128))]}),_:1})],512),m(o.NewComment,{class:"mx-3","post-id":s.postId,onCommented:n.onCommented,onContadorActualizado:n.contadorActualizado},null,8,["post-id","onCommented","onContadorActualizado"])])])}var R=b(K,[["render",$],["__scopeId","data-v-d7ba54a4"]]);const tt={components:{SeccionComentariosComponent:R,ImagePreloader:j,PetIconList:N,PostMenu:B,ReactAndCommentButtons:V},data(){return{}},methods:{contadorActualizado(t){this.comments_count=t},back(){this.$router.replace("/")},react(t){this.my_reaction=t.own_reaction,this.reactions_count=t.reactions_count}}},ot=Object.assign(tt,{async setup(t,{expose:c}){c();let s,o;const i=v(),n=L();let a=null,d=null,l=null,p=null;[s,o]=O(()=>F(`${i.backendUrl}/api/posts/${n.params.id}`).then(C=>{a=C.data,d=a.my_reaction,l=a.reactions_count,p=a.comments_count})),await s,o();const h={mainStore:i,route:n,post:a,my_reaction:d,reactions_count:l,comments_count:p,SeccionComentariosComponent:R,ImagePreloader:j,PetIconList:N,PostMenu:B,ReactAndCommentButtons:V,useMainStore:v,t:I,timeAgo:U};return Object.defineProperty(h,"__isScriptSetup",{enumerable:!1,value:!0}),h}}),et=t=>(q("data-v-556e7d3d"),t=t(),G(),t),st={class:"row"},nt={class:"col-7"},at={class:"col-5"},ct={class:"card shadow-sm",style:{height:"calc(100vh - 120px)"}},it={class:"card-body p-0 container-x"},rt={class:"row g-0 p-3 pb-0"},dt={class:"col-auto"},lt={class:"col px-2"},mt={class:"d-block text-black-50 fs-6",role:"button"},_t={class:"col-auto"},ut=et(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32.055 32.055",width:"20",height:"20",class:"text-black-50",fill:"currentColor","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("path",{d:`M3.968,12.061C1.775,12.061,0,13.835,0,16.027c0,2.192,1.773,3.967,3.968,3.967c2.189,0,3.966-1.772,3.966-3.967
              C7.934,13.835,6.157,12.061,3.968,12.061z M16.233,12.061c-2.188,0-3.968,1.773-3.968,3.965c0,2.192,1.778,3.967,3.968,3.967
              s3.97-1.772,3.97-3.967C20.201,13.835,18.423,12.061,16.233,12.061z M28.09,12.061c-2.192,0-3.969,1.774-3.969,3.967
              c0,2.19,1.774,3.965,3.969,3.965c2.188,0,3.965-1.772,3.965-3.965S30.278,12.061,28.09,12.061z`})],-1)),pt={class:"fs-6 mt-1 mb-1 mx-3 text-muted"};function ht(t,c,s,o,i,n){var d,l,p,h,C,k,P,z;const a=H;return r(),_("div",st,[e("div",nt,[m(o.ImagePreloader,{aspect:(d=o.post)==null?void 0:d.simple_post.aspect_ratio,image:(l=o.post)==null?void 0:l.simple_post.image,option:"url_xl","object-fit":"contain",style:{width:"100%",height:"600px",display:"block"},class:"rounded-5 w-100 shadow-sm"},null,8,["aspect","image"])]),e("div",at,[e("div",ct,[e("div",it,[e("div",rt,[e("div",dt,[m(a,{to:"/@"+((p=o.post)==null?void 0:p.user.username)},{default:w(()=>{var f;return[m(o.ImagePreloader,{image:(f=o.post)==null?void 0:f.user.image,class:"img-user-post shadow"},null,8,["image"])]}),_:1},8,["to"])]),e("div",lt,[m(a,{to:"/@"+((h=o.post)==null?void 0:h.user.username),class:"name-user-post fw-bold text-decoration-none text-dark"},{default:w(()=>{var f;return[S(g((f=o.post)==null?void 0:f.user.name),1)]}),_:1},8,["to"]),e("span",mt,[e("small",null,g(o.timeAgo((C=o.post)==null?void 0:C.created_at)),1)])]),e("div",_t,[ut,m(o.PostMenu,{"post-id":(k=o.post)==null?void 0:k.id},null,8,["post-id"])])]),e("p",pt,g((P=o.post)==null?void 0:P.simple_post.description),1),(z=o.post)!=null&&z.pets_count?(r(),x(o.PetIconList,{key:0,pets:o.post.pets,"pets-count":o.post.pets_count,class:"px-3"},null,8,["pets","pets-count"])):u("",!0),o.post?(r(),x(o.ReactAndCommentButtons,{key:1,id:o.post.id,"my-reaction":o.my_reaction,"reactions-count":o.reactions_count,"comments-count":o.comments_count,onReact:n.react},null,8,["id","my-reaction","reactions-count","comments-count","onReact"])):u("",!0),o.post?(r(),x(o.SeccionComentariosComponent,{key:2,"post-id":o.post.id,onContadorActualizado:n.contadorActualizado,style:{"flex-grow":"1",overflow:"hidden"}},null,8,["post-id","onContadorActualizado"])):u("",!0)])])])])}var ft=b(ot,[["render",ht],["__scopeId","data-v-556e7d3d"]]);const gt={components:{ViewPost:ft}};function Ct(t,c,s,o,i,n){const a=W("ViewPost");return r(),_(A,null,[S(" ver post "+g(t.$route.params.id)+" ",1),m(a)],64)}var yt=b(gt,[["render",Ct]]);export{yt as default};
